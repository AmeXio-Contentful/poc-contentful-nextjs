fragment PostCategoryFields on Category {
  sys {
    id
  }
  categoryName
  slug
}

fragment PostBaseFields on Post {
  __typename
  sys {
    id
  }
  internalName
  postName
  publishedDate
  featuredImage {
    ...AssetFields
  }
  slug
  category {
    ...PostCategoryFields
  }
  author {
    ...PersonFields
  }
  introText {
    json
  }
  contentfulMetadata {
    tags {
      id
      name
    }
  }
}

fragment PostFields on Post {
  ...PostBaseFields
  seo {
    title
    description
    image {
      ...AssetFields
    }
    noIndex
    noFollow
  }
  introText {
    json
    links {
      entries {
        block {
          ...ComponentReferenceFields
        }
      }
      assets {
        block {
          ...AssetFields
        }
      }
    }
  }
  body {
    json
    links {
      entries {
        block {
          ...ComponentReferenceFields
        }
      }
      assets {
        block {
          ...AssetFields
        }
      }
    }
  }
  extraSectionCollection(limit: 20) {
    items {
      ...ComponentReferenceFields
    }
  }
}

query CtfPost($slug: String!, $locale: String, $preview: Boolean) {
  postCollection(where: { slug: $slug }, locale: $locale, preview: $preview, limit: 1) {
    items {
      ...PostFields
    }
  }
}

query CtfBlog($locale: String, $preview: Boolean) {
  postCollection(locale: $locale, preview: $preview, limit: 10, order: publishedDate_DESC) {
    items {
      ...PostBaseFields
    }
  }
}
